



<!DOCTYPE html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
        <meta name="description" content="TomoChain aims to be a public EVM-compatible blockchain with the following advantages as low transaction fee, fast confirmation time, double validation.">
      
      
        <link rel="canonical" href="https://docs.tomochain.com/wp-and-research/privacy/">
      
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../../images/favicon.png">
      <meta name="generator" content="mkdocs-1.0.4, mkdocs-material-3.0.4">
    
    
      
        <title>TomoP whitepaper - TomoChain Documentation</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/application.451f80e5.css">
      
      
    
    
      <script src="../../assets/javascripts/modernizr.1aa3b519.js"></script>
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="../../assets/fonts/material-icons.css">
    
      <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.1/css/font-awesome.min.css">
    
      <link rel="stylesheet" href="../../css/style.css">
    
    
  </head>
  
    <body dir="ltr">
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448"
    viewBox="0 0 416 448" id="__github">
  <path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19-18.125
        8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19 18.125-8.5
        18.125 8.5 10.75 19 3.125 20.5zM320 304q0 10-3.125 20.5t-10.75
        19-18.125 8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19
        18.125-8.5 18.125 8.5 10.75 19 3.125 20.5zM360
        304q0-30-17.25-51t-46.75-21q-10.25 0-48.75 5.25-17.75 2.75-39.25
        2.75t-39.25-2.75q-38-5.25-48.75-5.25-29.5 0-46.75 21t-17.25 51q0 22 8
        38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0
        37.25-1.75t35-7.375 30.5-15 20.25-25.75 8-38.375zM416 260q0 51.75-15.25
        82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5-41.75
        1.125q-19.5 0-35.5-0.75t-36.875-3.125-38.125-7.5-34.25-12.875-30.25-20.25-21.5-28.75q-15.5-30.75-15.5-82.75
        0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25
        30.875q36.75-8.75 77.25-8.75 37 0 70 8 26.25-20.5
        46.75-30.25t47.25-9.75q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34
        99.5z" />
</svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="../../#tomop-high-performance-and-anonymous-transfer-protocol-on-tomochain" tabindex="1" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="https://docs.tomochain.com" title="TomoChain Documentation" class="md-header-nav__button md-logo">
          
            <img src="../../images/logo.png" width="24" height="24">
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            
              <span class="md-header-nav__topic">
                TomoChain Documentation
              </span>
              <span class="md-header-nav__topic">
                TomoP whitepaper
              </span>
            
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          
            <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
            
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
          
        
      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            


  


  <a href="https://github.com/tomochain/docs/" title="Go to repository" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#__github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      tomochain/docs
    </div>
  </a>

          </div>
        </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="https://docs.tomochain.com" title="TomoChain Documentation" class="md-nav__button md-logo">
      
        <img src="../../images/logo.png" width="48" height="48">
      
    </a>
    TomoChain Documentation
  </label>
  
    <div class="md-nav__source">
      


  


  <a href="https://github.com/tomochain/docs/" title="Go to repository" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#__github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      tomochain/docs
    </div>
  </a>

    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-1" type="checkbox" id="nav-1">
    
    <label class="md-nav__link" for="nav-1">
      Get started
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-1">
        Get started
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../.." title="Introduction" class="md-nav__link">
      Introduction
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../get-started/productoverview/" title="Products overview" class="md-nav__link">
      Products overview
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../get-started/how_to_read/" title="How to read" class="md-nav__link">
      How to read
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../get-started/wallet/" title="Connect your wallet" class="md-nav__link">
      Connect your wallet
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../get-started/voting/" title="Voting" class="md-nav__link">
      Voting
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../general/networks/" title="Networks" class="md-nav__link">
      Networks
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../general/faq/" title="FAQ" class="md-nav__link">
      FAQ
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2">
    
    <label class="md-nav__link" for="nav-2">
      Masternode/DEX
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        Masternode/DEX
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../masternode/requirements/" title="Requirements" class="md-nav__link">
      Requirements
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../masternode/masternode-setup-guide/" title="Detailed guide" class="md-nav__link">
      Detailed guide
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2-3" type="checkbox" id="nav-2-3">
    
    <label class="md-nav__link" for="nav-2-3">
      Running a node with
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-2-3">
        Running a node with
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../masternode/tomonative/" title="Binary" class="md-nav__link">
      Binary
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../masternode/create-tomochain-masternode/" title="Create-tomochain-masternode" class="md-nav__link">
      Create-tomochain-masternode
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../masternode/tmn/" title="Tmn" class="md-nav__link">
      Tmn
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../masternode/docker/" title="Docker" class="md-nav__link">
      Docker
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../masternode/applying/" title="Applying for Masternode Candidacy" class="md-nav__link">
      Applying for Masternode Candidacy
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../masternode/snapshot/" title="Chaindata Snapshots" class="md-nav__link">
      Chaindata Snapshots
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../get-started/run-node/" title="Run a full node in testnet" class="md-nav__link">
      Run a full node in testnet
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../get-started/apply-node/" title="Apply your node in testnet" class="md-nav__link">
      Apply your node in testnet
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../masternode/tomox-fullnode/" title="Running a TomoX Mongodb fullnode" class="md-nav__link">
      Running a TomoX Mongodb fullnode
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../masternode/tomox-sdk/" title="Running a TomoX DEX" class="md-nav__link">
      Running a TomoX DEX
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3">
    
    <label class="md-nav__link" for="nav-3">
      Developers guide
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        Developers guide
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../general/networks/" title="Networks" class="md-nav__link">
      Networks
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-2" type="checkbox" id="nav-3-2">
    
    <label class="md-nav__link" for="nav-3-2">
      Integrations
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-3-2">
        Integrations
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/integrations/" title="TOMO Exchange/Wallet" class="md-nav__link">
      TOMO Exchange/Wallet
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/staking-integrations/" title="TomoChain Staking Governance" class="md-nav__link">
      TomoChain Staking Governance
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/trc20-integrations/" title="TRC20 Exchange/Wallet" class="md-nav__link">
      TRC20 Exchange/Wallet
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/trc21-integrations/" title="TRC21 Exchange/Wallet" class="md-nav__link">
      TRC21 Exchange/Wallet
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-3" type="checkbox" id="nav-3-3">
    
    <label class="md-nav__link" for="nav-3-3">
      Working with TomoChain
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-3-3">
        Working with TomoChain
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/tutoprivatenet/" title="TomoChain private testnet setup" class="md-nav__link">
      TomoChain private testnet setup
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/clicommands/" title="Useful manual CLI commands" class="md-nav__link">
      Useful manual CLI commands
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-4" type="checkbox" id="nav-3-4">
    
    <label class="md-nav__link" for="nav-3-4">
      DApps on TomoChain
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-3-4">
        DApps on TomoChain
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/dappdeploytuto/" title="Deploy DApp on TomoChain" class="md-nav__link">
      Deploy DApp on TomoChain
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/icosmartcontract/" title="Deploy an ICO smart contract" class="md-nav__link">
      Deploy an ICO smart contract
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="https://apidocs.tomochain.com" title="API Documentation" class="md-nav__link">
      API Documentation
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4" checked>
    
    <label class="md-nav__link" for="nav-4">
      Whitepapers/Specs
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        Whitepapers/Specs
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../technical-whitepaper/" title="Technical whitepaper" class="md-nav__link">
      Technical whitepaper
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../sharding-paper/" title="Sharding design paper" class="md-nav__link">
      Sharding design paper
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../economics-paper/" title="Economics paper" class="md-nav__link">
      Economics paper
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-4" type="checkbox" id="nav-4-4">
    
    <label class="md-nav__link" for="nav-4-4">
      Standard & Specification
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-4">
        Standard & Specification
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../specs/trc21_standard/" title="TRC21 Specification" class="md-nav__link">
      TRC21 Specification
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        TomoP whitepaper
      </label>
    
    <a href="./" title="TomoP whitepaper" class="md-nav__link md-nav__link--active">
      TomoP whitepaper
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#why-privacy-matters" title="Why privacy matters?" class="md-nav__link">
    Why privacy matters?
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#background" title="Background" class="md-nav__link">
    Background
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pederson-commitment" title="Pederson commitment" class="md-nav__link">
    Pederson commitment
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tomop-architecture" title="TomoP architecture" class="md-nav__link">
    TomoP architecture
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#transaction-fee-and-tomoz-integration" title="Transaction fee and TomoZ integration" class="md-nav__link">
    Transaction fee and TomoZ integration
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tomops-privacy-address" title="TomoP's privacy address" class="md-nav__link">
    TomoP's privacy address
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ring-confidential-transaction-and-bulletproofs" title="Ring Confidential Transaction and Bulletproofs" class="md-nav__link">
    Ring Confidential Transaction and Bulletproofs
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#confidential-transaction" title="Confidential transaction" class="md-nav__link">
    Confidential transaction
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#range-proofs-with-bulletproofs" title="Range proofs with Bulletproofs" class="md-nav__link">
    Range proofs with Bulletproofs
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#implementation" title="Implementation" class="md-nav__link">
    Implementation
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#privacy-precompiled-contracts" title="Privacy precompiled contracts" class="md-nav__link">
    Privacy precompiled contracts
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#anonymize-tomo" title="Anonymize TOMO" class="md-nav__link">
    Anonymize TOMO
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#anonymous-send" title="Anonymous send" class="md-nav__link">
    Anonymous send
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#anonymous-send-transaction-verification-on-smart-contracts" title="Anonymous send transaction verification on smart contracts" class="md-nav__link">
    Anonymous send transaction verification on smart contracts
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#anonymous-reception-of-tomo" title="Anonymous reception of TOMO" class="md-nav__link">
    Anonymous reception of TOMO
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#private-token-standard" title="Private token standard" class="md-nav__link">
    Private token standard
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#regulatory-compliance" title="Regulatory compliance" class="md-nav__link">
    Regulatory compliance
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#references" title="References" class="md-nav__link">
    References
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-5" type="checkbox" id="nav-5">
    
    <label class="md-nav__link" for="nav-5">
      Legal
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-5">
        Legal
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../legal/terms-of-use/" title="Terms of Use" class="md-nav__link">
      Terms of Use
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../legal/privacy/" title="Privacy Policy" class="md-nav__link">
      Privacy Policy
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6" type="checkbox" id="nav-6">
    
    <label class="md-nav__link" for="nav-6">
      Products
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-6">
        Products
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../products/tomomaster/features/" title="TomoMaster" class="md-nav__link">
      TomoMaster
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../products/tomoscan/features/" title="TomoScan" class="md-nav__link">
      TomoScan
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6-3" type="checkbox" id="nav-6-3">
    
    <label class="md-nav__link" for="nav-6-3">
      TomoWallet
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-6-3">
        TomoWallet
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../products/tomowallet/features/" title="Features" class="md-nav__link">
      Features
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../products/tomowallet/voting/" title="Voting with TomoWallet" class="md-nav__link">
      Voting with TomoWallet
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../products/tomowallet/terms/" title="Terms & Privacy" class="md-nav__link">
      Terms & Privacy
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6-4" type="checkbox" id="nav-6-4">
    
    <label class="md-nav__link" for="nav-6-4">
      TomoBridge
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-6-4">
        TomoBridge
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../products/tomobridge/faq/" title="FAQ" class="md-nav__link">
      FAQ
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6-5" type="checkbox" id="nav-6-5">
    
    <label class="md-nav__link" for="nav-6-5">
      TomoIssuer
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-6-5">
        TomoIssuer
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../products/tomoissuer/" title="Overview" class="md-nav__link">
      Overview
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../products/tomoissuer/termofcondition/" title="Term Of Condition" class="md-nav__link">
      Term Of Condition
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../products/tomoissuer/policyprivacy/" title="Policy Privacy" class="md-nav__link">
      Policy Privacy
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#why-privacy-matters" title="Why privacy matters?" class="md-nav__link">
    Why privacy matters?
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#background" title="Background" class="md-nav__link">
    Background
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pederson-commitment" title="Pederson commitment" class="md-nav__link">
    Pederson commitment
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tomop-architecture" title="TomoP architecture" class="md-nav__link">
    TomoP architecture
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#transaction-fee-and-tomoz-integration" title="Transaction fee and TomoZ integration" class="md-nav__link">
    Transaction fee and TomoZ integration
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tomops-privacy-address" title="TomoP's privacy address" class="md-nav__link">
    TomoP's privacy address
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ring-confidential-transaction-and-bulletproofs" title="Ring Confidential Transaction and Bulletproofs" class="md-nav__link">
    Ring Confidential Transaction and Bulletproofs
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#confidential-transaction" title="Confidential transaction" class="md-nav__link">
    Confidential transaction
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#range-proofs-with-bulletproofs" title="Range proofs with Bulletproofs" class="md-nav__link">
    Range proofs with Bulletproofs
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#implementation" title="Implementation" class="md-nav__link">
    Implementation
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#privacy-precompiled-contracts" title="Privacy precompiled contracts" class="md-nav__link">
    Privacy precompiled contracts
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#anonymize-tomo" title="Anonymize TOMO" class="md-nav__link">
    Anonymize TOMO
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#anonymous-send" title="Anonymous send" class="md-nav__link">
    Anonymous send
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#anonymous-send-transaction-verification-on-smart-contracts" title="Anonymous send transaction verification on smart contracts" class="md-nav__link">
    Anonymous send transaction verification on smart contracts
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#anonymous-reception-of-tomo" title="Anonymous reception of TOMO" class="md-nav__link">
    Anonymous reception of TOMO
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#private-token-standard" title="Private token standard" class="md-nav__link">
    Private token standard
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#regulatory-compliance" title="Regulatory compliance" class="md-nav__link">
    Regulatory compliance
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#references" title="References" class="md-nav__link">
    References
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/tomochain/docs/edit/master/docs/wp-and-research/privacy.md" title="Edit this page" class="md-icon md-content__icon">&#xE3C9;</a>
                
                
                <h1 id="tomop-high-performance-and-anonymous-transfer-protocol-on-tomochain">TomoP - High Performance and Anonymous Transfer Protocol on TomoChain<a class="headerlink" href="#tomop-high-performance-and-anonymous-transfer-protocol-on-tomochain" title="Permanent link">&para;</a></h1>
<p>A tremendous amount of work and investment has been devoted to the development of blockchain technology to solve current 
problems, i.e. scalability and privacy, with the technology itself as well as to 
maximize the adoption of the technology in daily life. </p>
<p>The majority of public blockchain technology/platforms have a built-in cryptocurrency 
in which every transaction shows the amount of tokens or native coins 
that the sender is transferring to the recipient. 
In this regard, blockchain provides transparency to all users, 
which is not always expected by the majority of businesses. A business would 
like to hide the transaction amount, instead of showing it to everyone.</p>
<p>This paper presents TomoP - a protocol proposed by TomoChain for private transactions on the TomoChain public blockchain.
The paper describes a protocol that allows creating anonymous transactions that hide 
the transaction value, sender, and receiver to 
preserve the financial privacy of holders of TOMO and tokens on TomoChain.
TomoP is the first ever EVM-compatible private transaction protocol with very fast transaction speed 
that allows anonymizing the transaction sender
in a transaction without requiring an intermediary.</p>
<p>TomoP solves the following problems:</p>
<ul>
<li>
<p>Performance: Most (if not all) current privacy <code>coins</code>, i.e. Monero, ZCoin, ZCash, are slow
because of high block time in the consensus protocol of those public chains. TomoP operates as
a DApp on TomoChain, which provides transaction confirmation within 2-4 seconds.</p>
</li>
<li>
<p>Transaction sender anonymity: most EVM smart contract-based private transactions require a 
<a href="https://ethresear.ch/t/burn-relay-registry-decentralized-transaction-abstraction-on-layer-2/5820">relayer</a>
to sign a private transaction to pay the transaction gas that will eventually be refunded.
This makes the privacy transaction system semi-decentralized. 
TomoP, on the other hand, uses TomoZ - the protocol to make gasless transactions without
requiring a <code>relayer</code> between the transaction creator and the blockchain.</p>
</li>
<li>
<p>Out-of-gas: Verifying cryptographic proofs in private transactions requires intensive computation, which 
could cause the out-of-gas problem in EVM environment. 
To reduce gas consumption and speed up transaction proof verification, TomoP implements a set of 
precompiled contracts integrated in the core EVM of TomoChain. </p>
</li>
<li>
<p>TomoP allows creating a private token standard to 
make super fast token-based payment systems and DApps on TomoChain. </p>
</li>
</ul>
<p>TomoP relies on the following techniques:</p>
<ul>
<li>
<p>Cryptographic privacy building blocks include:</p>
<ul>
<li>Stealth address: This technique is used for obfuscating transaction recipients by generating a new one-time public key
for every transaction recipient so that there is no way for a third party to find the relationships
between 2 different transaction recipients. What this means is that, if <code>Alice</code> is sending 2 transactions to
<code>Bob</code>, no one, except <code>Alice</code> and <code>Bob</code> could find out the fact that <code>Bob</code> is the recipient in both transactions.</li>
<li>Ring Signature and Ring Confidential Transaction (RingCT): These are techniques used by Monero for obfuscating
transaction senders and transaction amounts in a transaction. </li>
<li>Bulletproofs: Zero-knowledge proofs that allow proving an encrypted number is within a range
without revealing the number itself. 
Bulletproofs are used in TomoP transactions to prove that a transaction amount in a private transaction
is positive in order to prevent double spending.</li>
</ul>
</li>
<li>
<p>TomoZ: TomoZ is the first decentralized gasless transaction protocol on TomoChain. 
TomoP relies on TomoZ to create a transaction fee vault for private transactions.
This fee vault is stored in <a href="http://issuer.tomochain.com/">TomoIssuer</a> contract on TomoChain to
pay the network fee while the actual private transaction fee is paid internally in the private transaction.</p>
</li>
<li>
<p>Precompiled contracts: A set of precompiled contracts for Ring Signature verification and Bulletproof range proof
is integrated directly into the core EVM of TomoChain. 
This allows any smart contract (i.e. private token contract) to call those precompiled contracts to verify cryptographic proofs.</p>
</li>
</ul>
<h2 id="why-privacy-matters">Why privacy matters?<a class="headerlink" href="#why-privacy-matters" title="Permanent link">&para;</a></h2>
<p>Privacy is necessary for ensuring freedom on the internet. 
When your transactions are being watched — or 
when your transaction history is available to be known — 
a person isn't free to make their own decisions. 
With other digital currencies, bad actors are able to match 
people to their balances and details about parties involved, amounts and trends.</p>
<h2 id="background">Background<a class="headerlink" href="#background" title="Permanent link">&para;</a></h2>
<p>Blockchain technology fundamentally relies on distributed system principles and 
cryptography techniques, especially digital signature algorithms. 
Elliptic Curve Digital Signature Algorithm (ECDSA) is widely used in 
most blockchain systems such as Bitcoin, Ethereum, and TomoChain to 
generate a signature in order to authenticate the sender of a transaction. 
The most widely used elliptic curve in blockchains is secp256k1. </p>
<p>The 64-character string called private key is the most important 
information that any holder should keep private. 
A private key can be used for generating a public key, which is in turn used 
for deriving an Ethereum user address (40 hex characters) that every cryptocurrency 
holder is familiar with.</p>
<p>Mathematically, an address X can be generated from a private key P as follows:</p>
<div class="codehilite"><pre><span></span><code>Pk = P*G
X = bytes20(SHA256(Pk))
</code></pre></div>


<p>Where <code>Pk</code> denotes the public key derived from the private key, 
<code>SHA256</code> is the cryptographic hash, <code>bytes20</code> takes the first 20 bytes of any data, 
and <code>G</code> is a common generator point in secp256k1 curve. 
Eventually, <code>X</code> is a 40-character string (20 bytes) derived from the private key.</p>
<p>The multiplication <code>P*G</code> is called elliptic multiplication. 
It is easy to compute a public key from a private key but it is 
infeasible to compute a private key from a given public key 
(there is no division in the elliptic curve number space).</p>
<h3 id="pederson-commitment">Pederson commitment<a class="headerlink" href="#pederson-commitment" title="Permanent link">&para;</a></h3>
<p>Pederson commitment is a cryptographic commitment scheme equivalent to 
secretly writing a secret message m in a sealed, tamper-evident, 
individually numbered (or/and countersigned) envelope kept by who wrote the message. 
The envelope's content can't be changed by any means, and the message does not 
leak any information.</p>
<p>In TomoP, a Pederson commitment C to a number <code>f</code> is defined as follows:</p>
<p><code>C = m*G + f*H</code></p>
<p>Where <code>m</code> is 256-bit number called blinding factor/mask, and <code>H</code> is another generator point. </p>
<p>If we consider f as an account’s balance on TomoChain, the commitment C can be used 
for hiding the transaction amount of such account. 
In other words, <code>C</code> is the Pederson encrypted amount of such account.</p>
<p>Pederson commitment is a form of additively homomorphic encryption, 
which has the following nice property: The sum of two Pederson commitments to f1 and f2 is equal to the Pederson commitment of f1 + f2.</p>
<div class="codehilite"><pre><span></span><code>        `C(m1, f1) + C(m2, f2) = C(m1 + m2, f1 + f2)`
</code></pre></div>


<p>This is the key application of Pederson commitment to most privacy-focused blockchains.</p>
<h2 id="tomop-architecture">TomoP architecture<a class="headerlink" href="#tomop-architecture" title="Permanent link">&para;</a></h2>
<p>TomoP supports both an anonymous TOMO transfer method and a private token standard on TomoChain.</p>
<p>The following figure shows the overview of TomoP that is integrated both at the core and the smart contract
layer of TomoChain.</p>
<p><img alt="overviewprivacy" id="fig:overviewprivacy" src="/assets/overviewprivacy.png" /><em>Figure 1: Overview of TomoP</em></p>
<p>Instead of directly sending funds to the recipient, the sender will anonymize their TOMO by making a 
transaction to the <code>Privacy</code> smart contract. 
As long as send transactions are made to the privacy contract, 
the latter allows TOMO holders to send/receiver TOMO to/from others 
without showing the transaction amount within it. 
TomoP transactions are like Monero transactions but in a smart contract on the very fast blockchain TomoChain.</p>
<p>Typically, funds flow as follows:</p>
<ul>
<li>
<p>A user anonymize her TOMO by making a deposit transaction to send TOMO to the 
privacy smart contract. 
This transaction is a normal transaction and does not hide the transaction amount.
This transaction creates a <code>Note</code> in the privacy contract. 
A note is similar to the concept of Unspent Transaction
Output (UTXO) on Bitcoin blockchain with additional information, i.e. a Pedersen commitment, that is used
for creating cryptographic proofs when the user wants to make an anonymous send transaction.</p>
</li>
<li>
<p>The user makes anonymous send transactions from the user to a recipient. 
The transaction amount is hidden. 
Funds are not moved out of the privacy contract. 
The user uses her own private key to create RingCT and Bulletproofs for 
the privacy contract to verify. 
Anonymous send obfuscates transaction sender and receiver, and hides transaction amounts.</p>
</li>
<li>
<p>The user can decide to de-anonymize her private TOMO by withdrawing all or part of her funds from the 
privacy contract to the user’s public wallet. 
The withdrawing amount is visible on the chain but the remaining funds 
of the user held in the privacy contract is always hidden.</p>
</li>
</ul>
<h3 id="transaction-fee-and-tomoz-integration">Transaction fee and TomoZ integration<a class="headerlink" href="#transaction-fee-and-tomoz-integration" title="Permanent link">&para;</a></h3>
<p>TomoP utilizes TomoZ - the core protocol of TomoChain allowing gasless transactions in a 
decentralized way to anonymize <code>msg.sender</code> in anonymous send transactions to the privacy smart contract.
TomoZ integration is very important to TomoP because of the way that it does not require an account to 
hold TOMO to make a transaction.</p>
<p>For example, when <code>Alice</code> wants to make an anonymous send transaction to the privacy contract, if <code>Alice</code> 
uses her private key to sign the transaction, every one would know that <code>Alice</code> is making a private transaction,
which would destroy the anonymity property of the protocol.  </p>
<p>Having a third-party such as <a href="https://ethresear.ch/t/burn-relay-registry-decentralized-transaction-abstraction-on-layer-2/5820">relayer</a>
to sign the transaction and pay the gas fee is promising but centralizing the protocol.
Integrating with TomoZ allows to create a privacy fee vault that is initially deposited by the issuer/owner of the privacy contract.</p>
<p>For every anonymous send transaction, <code>Alice</code> uses her private key to create cryptographic proofs: RingCT, Bulletproofs,
a brand new account/private key without TOMO is used for signing as <code>msg.sender</code>.
The actual network fee will be paid from the privacy vault fee to masternodes through TomoZ protocol.
On the other hand, to compensate the privacy transaction fee paid for masternodes, <code>Alice</code> sends a 0.01 TOMO fee 
to the issuer/owner within the smart contract execution of the anonymous transaction.
The transaction fee flow is as the following figure.</p>
<p><img alt="privacyfee" id="fig:privacyfee" src="/assets/privacyfee.png" /><em>Figure 2: Privacy transaction fee and TomoZ integration</em></p>
<h3 id="tomops-privacy-address">TomoP's privacy address<a class="headerlink" href="#tomops-privacy-address" title="Permanent link">&para;</a></h3>
<p>TomoP uses a single private key to generate a dual-key system.
The user private key <code>s</code> of the user's TOMO address is called private spend key and <code>v = SHA256(s)</code> is 
the private view key of the user.
As the names imply:</p>
<ul>
<li>Private spend key <code>s</code>: This is used for making cryptographic proofs for spending funds in the privacy contract.</li>
<li>Private view key <code>v</code>: This is used for viewing the information of all transactions belonging to the user. </li>
</ul>
<p>Having <code>v</code> only allows seeing the transaction history of the user, but does not allow spending funds.
This could be used as a tool for authorized parties to check the transaction history of a user
by requiring the user to register her private view key to the authorized parties for regulatory compliance purposes.</p>
<p>Each private spend key <code>s</code> has an associated privacy address. 
The latter is Base58 encoding of the public spend (<code>S</code>) and public view (<code>V</code>) keys derived from <code>s</code> and <code>v</code>.  </p>
<p>When <code>Alice</code> wants to make an anonymous send transaction to <code>Bob</code>, <code>Bob</code> needs to send his privacy address
to <code>Alice</code>.</p>
<h2 id="ring-confidential-transaction-and-bulletproofs">Ring Confidential Transaction and Bulletproofs<a class="headerlink" href="#ring-confidential-transaction-and-bulletproofs" title="Permanent link">&para;</a></h2>
<h3 id="confidential-transaction">Confidential transaction<a class="headerlink" href="#confidential-transaction" title="Permanent link">&para;</a></h3>
<p><a href="https://people.xiph.org/~greg/confidential_values.txt">Confidential transaction</a> was proposed for 
Bitcoin privacy integration by Greg Maxwell.
It uses Pedersen commitment to encrypt transaction amounts using randomly generated masks.
Cryptographically, confidential transaction states that the sum of Pedersen commitments of all input <code>notes</code>
must be equal to the sum of all Pedersen commitments of all output <code>notes</code>. 
Users are recommended to check <a href="https://people.xiph.org/~greg/confidential_values.txt">confidential transaction</a>
to better understand how it works.</p>
<p>What confidential transaction does not support is transaction sender anonymity, which is
supported by Ring Confidential Transaction (RingCT) implemented by Monero.
RingCT is the combination of <a href="https://en.wikipedia.org/wiki/Ring_signature">Ring Signature</a> and Confidential Transaction.
Ring Signature allows to obfuscate transaction sender in an anonymity set, whose size is 12 in TomoP.</p>
<p>RingCT, however, requires the support of a zero-knowledge range proof in order to prove
the transaction amount committed in a Pedersen commitment is positive to prevent from double spending.
This is supported by <a href="https://eprint.iacr.org/2017/1066.pdf">Bulletproofs</a> which supports short non-interactive proofs without a trusted setup for confidential transactions. </p>
<h3 id="range-proofs-with-bulletproofs">Range proofs with Bulletproofs<a class="headerlink" href="#range-proofs-with-bulletproofs" title="Permanent link">&para;</a></h3>
<p>Range proofs is a type of zero-knowledge proof used for proving that a 
secret value is within a value range without revealing the precise value of the secret. 
Bulletproofs is a new non-interactive zero-knowledge proof protocol 
with very short proofs and without a trusted setup; the proof size 
is only logarithmic in the witness size. </p>
<p>TomoP uses Bulletproofs range proof to prove the transaction amount commited in Pedersen commitments is positive.
Both Bulletproofs and RingCT are implemented in our <a href="https://github.com/tomochain/privacyjs">privacy SDK</a>.</p>
<h2 id="implementation">Implementation<a class="headerlink" href="#implementation" title="Permanent link">&para;</a></h2>
<h3 id="privacy-precompiled-contracts">Privacy precompiled contracts<a class="headerlink" href="#privacy-precompiled-contracts" title="Permanent link">&para;</a></h3>
<p>To reduce the gas consumption of RingCT and Bulletproof verification, we propose two precompiled contracts, 
<code>RingCTVerifier</code> and <code>BulletproofVerifier</code>, that are implemented in the core EVM of TomoChain, using Golang.
These two precompiled contracts will be called by the privacy contract to verify the confidential transaction and Bulletproof
range proof, respectively. 
The current addresses for those precompiled contracts are 0x000000000000000000000000000000000000001e and 0x0000000000000000000000000000000000000028.</p>
<h3 id="anonymize-tomo">Anonymize TOMO<a class="headerlink" href="#anonymize-tomo" title="Permanent link">&para;</a></h3>
<p>Anonymizing TOMO is equal to making a deposit transaction to the privacy contract.
The deposit transaction creates a new <code>Note</code> <code>n</code> in the privacy contract that has the following cryptographic elements:</p>
<ul>
<li>A transaction public key <code>P</code><sub>tx</sub></li>
<li>A stealth, one-time public key <code>P</code><sub>st</sub></li>
<li>A Pedersen commitment <code>C</code> of the deposit amount</li>
</ul>
<p>A deposit fee of 0.001 TOMO is applied to pay transaction fees for 
the person who deposits to the privacy transaction fee vault.</p>
<p>Once deposited, the privacy smart contract records that the person that has the private key corresponding to
the deposit stealth public key has the deposit amount in a note.</p>
<h3 id="anonymous-send">Anonymous send<a class="headerlink" href="#anonymous-send" title="Permanent link">&para;</a></h3>
<p>Suppose <code>Bob</code> wants to receive <code>x</code> TOMO from <code>Alice</code> via an anonymous send transaction.</p>
<ol>
<li><code>Bob</code> sends his privacy address to <code>Alice</code></li>
<li><code>Alice</code> derives a stealth one-time public key <code>Stealth</code><sub>b</sub> as follows:<ul>
<li><code>Alice</code> decodes the Base58 privacy address of <code>Bob</code> to have the public spend <code>S</code><sub>b</sub> 
and public view <code>V</code><sub>b</sub> key of <code>Bob</code>.</li>
<li><code>Alice</code> generates a random 256-bit number transaction private key <code>s</code><sub>tx</sub> and computes 
the corresponding transaction public key <code>S</code><sub>tx</sub> <code>= s</code><sub><code>tx</code></sub><code>*G</code>. </li>
<li><code>Alice</code> computes the Elliptic Curve Diff Hellman (ECDH) <code>E = s</code><sub>tx</sub><code>* V</code><sub>b</sub></li>
<li><code>Alice</code> computes <code>Stealth</code><sub>b</sub> = <code>E * G + S</code><sub>b</sub>.</li>
</ul>
</li>
<li><code>Alice</code> generates Pedersen commitment for the transaction amount <code>x</code>.<ul>
<li><code>Alice</code> randomly generates a 256-bit number called mask <code>m</code></li>
<li><code>Alice</code> creates a Pedersen commitment <code>C = m*G + x*H</code></li>
<li><code>Alice</code> encrypts <code>m</code> and <code>x</code> using the Elliptic Curve Diff Hellman <code>E</code> with an Advanced Encryption Standard (AES) algorithm. 
Let's denote the cipher text produced by this encryption <code>MX</code>.</li>
</ul>
</li>
<li><code>Alice</code> generates ring confidential transaction RingCT <code>sig</code> for the transaction (details are provided later).</li>
<li><code>Alice</code> generates a bulletproof range proof <code>bp</code> to prove that <code>x</code> is positive without revealing the value of <code>x</code>. </li>
<li><code>Alice</code> bundles (<code>S</code><sub>tx</sub>, <code>Stealth</code><sub>b</sub>, <code>C</code>, <code>MX</code>, <code>sig</code>, <code>bp</code>) into the data of a transaction,
generates a random private key to sign the transaction (to anonymize <code>msg.sender</code>), and sends the signed 
transaction to the privacy smart contract.</li>
</ol>
<p>The generation of RingCT and Bulletproofs will be posted in details in TomoChain's technical blog later. </p>
<p>Note that RingCT is generated by taking into account the transaction fee of 0.01 TOMO.
The algorithm to generate <code>sig</code> is similar to the one described in <a href="https://lab.getmonero.org/pubs/MRL-0005.pdf">Monero RingCT</a>.</p>
<p>In Step 6, TomoZ empowers the anonymization of <code>msg.sender</code> through the privacy fee vault and the paying of transaction 
fee within the internal execution of the privacy smart contract.</p>
<h3 id="anonymous-send-transaction-verification-on-smart-contracts">Anonymous send transaction verification on smart contracts<a class="headerlink" href="#anonymous-send-transaction-verification-on-smart-contracts" title="Permanent link">&para;</a></h3>
<p>The privacy smart contract basically verifies: </p>
<ul>
<li>The existence of all input notes in the transaction</li>
<li>The validity of the ring confidential transaction (RingCT) <code>sig</code> by calling <code>RingCTVerifier</code> precompiled contract.</li>
<li>The validity of Bulletproofs <code>bp</code> by calling <code>BulletproofVerifier</code> precompiled contract.</li>
</ul>
<h3 id="anonymous-reception-of-tomo">Anonymous reception of TOMO<a class="headerlink" href="#anonymous-reception-of-tomo" title="Permanent link">&para;</a></h3>
<p>Once the transaction is confirmed, <code>Bob</code> needs to scan all newly created <code>notes</code> on the privacy smart contract
to recognize which one belongs to him.
<code>Bob</code> uses his private view key to decode the encrypted transaction amount. 
A proof-of-concept code for the privacy contract can be found <a href="https://github.com/tomochain/privacy-sc">here</a>.</p>
<p>Due to the math complexity of RingCT and Bulletproofs, we omit the construction algorithms for those proofs here
and will detail them in TomoChain's tech blog.</p>
<h2 id="private-token-standard">Private token standard<a class="headerlink" href="#private-token-standard" title="Permanent link">&para;</a></h2>
<p>TomoP is designed to support private tokens issued on TomoChain.
A new private token standard TRC21P will be supportec by extending the TRC21 token standard. </p>
<h2 id="regulatory-compliance">Regulatory compliance<a class="headerlink" href="#regulatory-compliance" title="Permanent link">&para;</a></h2>
<p>By using a dual-key-like system, any user could register her/his private view key to an authorized authority.
The latter will then be able to decode all transactions that involve the user but will not be able to 
create an anonymous send transaction.<br />
The authorized authority would be the goverment tax agency or any organization that allows to track user transactions
for legal purposes.
Even a bank could use TomoP to keep track of their user balance while leaving only authorized users with private
spend keys to make transactions.</p>
<h2 id="references">References<a class="headerlink" href="#references" title="Permanent link">&para;</a></h2>
<p>On-going development Github repositories for TomoP</p>
<ol>
<li><a href="https://github.com/tomochain/privacy-sc">https://github.com/tomochain/privacy-sc</a> - contains privacy and utility contract solidity code</li>
<li><a href="https://github.com/tomochain/tomop">https://github.com/tomochain/tomop</a> - contains source code for precompiled contracts</li>
<li><a href="https://github.com/tomochain/tomowallet-web-testnet">https://github.com/tomochain/tomowallet-web-testnet</a> - proof-of-concept web wallet</li>
<li><a href="https://github.com/tomochain/privacyjs">https://github.com/tomochain/privacyjs</a> - SDK for TomoP to make anonymous transactions</li>
</ol>
                
                  
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../specs/trc21_standard/" title="TRC21 Specification" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                TRC21 Specification
              </span>
            </div>
          </a>
        
        
          <a href="../../legal/terms-of-use/" title="Terms of Use" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Terms of Use
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            If you wish to improve this site, please <a href="https://github.com/tomochain/docs/issues/new"><i class="fa fa-github"></i> open an issue</a> or <a href="https://github.com/tomochain/docs/compare"><i class="fa fa-github"></i> send a pull request</a>.<br>TomoDocs v0.1.0. TomoChain Project 2018.
          </div>
        
        powered by
        <a href="https://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
        
  <div class="md-footer-social">
    <link rel="stylesheet" href="../../assets/fonts/font-awesome.css">
    
      <a href="https://github.com/tomochain" class="md-footer-social__link fa fa-github"></a>
    
      <a href="https://twitter.com/tomochainANN" class="md-footer-social__link fa fa-twitter"></a>
    
      <a href="https://www.reddit.com/r/Tomochain/" class="md-footer-social__link fa fa-reddit"></a>
    
      <a href="https://www.facebook.com/tomochainofficial/" class="md-footer-social__link fa fa-facebook"></a>
    
      <a href="https://t.me/tomochain" class="md-footer-social__link fa fa-telegram"></a>
    
      <a href="https://medium.com/tomochain" class="md-footer-social__link fa fa-medium"></a>
    
  </div>

      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../assets/javascripts/application.583bbe55.js"></script>
      
      <script>app.initialize({version:"1.0.4",url:{base:"../.."}})</script>
      
        <script src="../../js/MathJax.js?config=TeX-AMS_HTML"></script>
      
    
    
      
        <script>!function(e,a,t,n,o,c,i){e.GoogleAnalyticsObject=o,e.ga=e.ga||function(){(e.ga.q=e.ga.q||[]).push(arguments)},e.ga.l=1*new Date,c=a.createElement(t),i=a.getElementsByTagName(t)[0],c.async=1,c.src="https://www.google-analytics.com/analytics.js",i.parentNode.insertBefore(c,i)}(window,document,"script",0,"ga"),ga("create","UA-124597188-1","docs.tomochain.com"),ga("set","anonymizeIp",!0),ga("send","pageview");var links=document.getElementsByTagName("a");if(Array.prototype.map.call(links,function(e){e.host!=document.location.host&&e.addEventListener("click",function(){var a=e.getAttribute("data-md-action")||"follow";ga("send","event","outbound",a,e.href)})}),document.forms.search){var query=document.forms.search.query;query.addEventListener("blur",function(){if(this.value){var e=document.location.pathname;ga("send","pageview",e+"?q="+this.value)}})}</script>
      
    
  </body>
</html>